/*! Stopwatch.js 1.0.0 | (c) 2014 Andrew Duthie <andrew@andrewduthie.com> | MIT License */
!function(a,b){"object"==typeof c?module.exports=b():"function"==typeof define&&define.amd&&define([],b);var c=b();for(var d in c)a[d]=c[d]}(this,function(){var correctingIntervals=[],now=Date.now||function(){return(new Date).valueOf()},setCorrectingInterval=function(){var instance={};instance.guid=correctingIntervals.length,correctingIntervals.push(instance);var tick=function(func,delay){if(!instance.started)return"string"==typeof func&&(func=function(){eval(this.func)}.bind({func:func})),instance.func=func instanceof Function?func:function(){},instance.delay=delay,instance.startTime=now(),instance.target=delay,instance.started=!0,instance.intervalId=setTimeout.apply(this,[tick].concat([].slice.call(arguments,1))),instance.guid;var elapsed=now()-instance.startTime,adjust=instance.target-elapsed,args=[].slice.call(arguments),timeoutArgs=[tick,instance.delay+adjust].concat(args);instance.func.apply(this,args),correctingIntervals[instance.guid]&&(instance.target+=instance.delay,instance.intervalId=setTimeout.apply(this,timeoutArgs))};return tick.apply(this,[].slice.call(arguments))},clearCorrectingInterval=function(a){correctingIntervals[a]&&(clearTimeout(correctingIntervals[a].intervalId),correctingIntervals[a]=null)};return{setCorrectingInterval:setCorrectingInterval,clearCorrectingInterval:clearCorrectingInterval}}),function(){var a,b;a=function(){function a(){this.tickIntervals=[],this.started=!1,this.running=!1,this.previousElapsed=0}return a.prototype.start=function(){return this.running?void 0:(this.startTime=(new Date).valueOf(),this._updateTickIntervals(),this.running=!0,this.started=!0)},a.prototype.pause=function(){var a,b,c,d;if(this.running){for(d=this.tickIntervals,b=0,c=d.length;c>b;b++)a=d[b],null!=a.intervalId&&clearCorrectingInterval(+a.intervalId);return this.running=!1,this.previousElapsed=this.getElapsed(),this.startTime=null}},a.prototype.stop=function(){return this.running&&this.pause(),this.previousElapsed=0,this.started=!1},a.prototype.getElapsed=function(){var a,b;return a=(new Date).valueOf(),b=this.startTime||a,a-b+this.previousElapsed},a.prototype.onTick=function(a,b,c){var d,e,f=this;if(null==b&&(b=1e3),null==c&&(c=!1),"function"!=typeof a)throw new TypeError("Must provide a valid callback function");return this.running?c||0===this.getElapsed()?this._startTicking(a,b,!0):(d=b-this.getElapsed()%b,e=function(){return f._startTicking(a,b)},setTimeout(e,d)):this._setTick(a,b,!0)},a.prototype.toString=function(){var a,b,c,d,e;return a=this.getElapsed(),d=a%1e3,a=(a-d)/1e3,e=a%60,a=(a-e)/60,c=a%60,b=(a-c)/60,("0"+b).slice(-2)+":"+("0"+c).slice(-2)+":"+("0"+e).slice(-2)+"."+("00"+d).slice(-3)},a.prototype._startTicking=function(a,b){var c;return c=this._setTick(a,b),c.intervalId=setCorrectingInterval(a,b)},a.prototype._setTick=function(a,c){var d;return d=new b(a,c,(new Date).valueOf()),this.tickIntervals.push(d),d},a.prototype._updateTickIntervals=function(){var a,b,c,d,e,f,g,h;c=[],g=this.tickIntervals;for(b in g)f=g[b],h=this,e=function(){return h._startTicking(this.callback,this.resolution)}.bind(f),a=(new Date).valueOf()-f.startTime,d=Math.abs(f.resolution-a%f.resolution),this.running&&d%f.resolution!==0?setTimeout(e,d):setTimeout(e,0);return this.tickIntervals=[]},a}(),b=function(){function a(a,b,c){this.callback=a,this.resolution=b,this.startTime=c}return a}(),this.Stopwatch=a,null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)&&(module.exports=a),"function"==typeof define&&null!=define.amd&&define("Stopwatch",function(){return a})}.call(this);